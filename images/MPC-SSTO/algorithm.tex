\documentclass[12pt,a4paper]{report}
\usepackage[utf8]{inputenc} %encoding multi-byte 
\usepackage[T1]{fontenc} %para los separación de palabras "can-ción"
\usepackage{mathptmx}
% -----------------------------------------------------------------------------
\usepackage{amsmath,amssymb,amsfonts,latexsym,textcomp} %paquetes matematicos
\usepackage{array,multirow,booktabs,tabulary} %tablas y arrays
\usepackage{graphicx}   
\usepackage{caption,float,subfigure} %float=figuras flotantes.
\usepackage{verbatim}  %texto raw 
\usepackage[ampersand]{easylist}
\usepackage{color}
\usepackage[usenames,dvipsnames,svgnames,table,x11names]{xcolor} 
\usepackage{multicol}

%font for mathcal using mathalfa
\usepackage[cal=cm]{mathalfa} 


% --- Algorithms2e ---------------------------------------------------------
\usepackage[linesnumbered,lined,ruled,commentsnumbered]{algorithm2e} %probar vlined o lined
% \SetKwProg{Prog}{Title}{is}{end} 
\SetKwProg{Config}{config}{}{end} 
\SetKwProg{Def}{def}{}{end} 
\SetKwProg{Fn}{Function}{}{end} 
\SetKwProg{Main}{main}{}{end} 

\begin{document}
	
\begin{algorithm}[H]
	\caption{MPC-SSTO}
	\KwData{$x(0),~Q,~R,~Ts,~N$}
	\KwResult{$u(k)$}
	\textbf{\textit{off-line mode:}}\;
	Solve the SSTO problem under constraints (7)\;
	Construct the LQ-MPC inequality constraints (4), and (5)\;
	Compute the deadbeat mode-2 terminal inequality constraint (6)\;
	Compute prediction matrices $F,~G$, and $H,~L,~M$\;
	Compute $P$ using the mode-2 gain $K_\infty$ to guarantee stability\;
	Initialize $x(0)\leftarrow x_0$\;
	\textbf{\textit{on-line mode:}}\;
	\For{$k=0:nk$}{
		Solve the SSTO problem under constraints (7)\;
		Measure the current output: $y(k)\leftarrow C~x(k)+D_d~d$\;	
		Solve the optimization problem for $v^*(k|k)$ (8)\;	
		Apply the first control input to the current state: $u(k)\leftarrow u_{ss}+v^*(k|k)$\;
		Close the loop: $x(k)\leftarrow A~x(k)+B~u(k)+B_d~d $\; 
		Wait one time step\;
		Increment $k$\;
	}
\end{algorithm}

\end{document}




